<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jujutsu Battle: Advanced</title>
    <style>
        :root { --main-bg: #0a0a0f; --panel-bg: rgba(20, 20, 30, 0.95); --hp-color: #2ecc71; --mp-color: #00d4ff; }
        body { background: #000; color: #fff; font-family: 'Helvetica Neue', sans-serif; display: flex; flex-direction: column; align-items: center; margin: 0; }
        
        #game-container { 
            width: 800px; height: 450px; background: linear-gradient(to bottom, #1a1a2e, #050505);
            position: relative; border: 4px solid #333; overflow: hidden; box-shadow: 0 0 30px rgba(0,212,255,0.2);
        }

        /* ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ */
        .char { position: absolute; transition: 0.3s cubic-bezier(0.17, 0.67, 0.83, 0.67); text-align: center; }
        .icon { font-size: 60px; filter: drop-shadow(0 0 10px rgba(0,0,0,0.8)); }
        
        /* ã‚²ãƒ¼ã‚¸é¡ */
        .bars { width: 100px; background: rgba(0,0,0,0.5); padding: 4px; border-radius: 4px; }
        .bar-bg { width: 100%; height: 6px; background: #222; border-radius: 3px; margin: 2px 0; overflow: hidden; }
        .hp-fill { height: 100%; background: var(--hp-color); width: 100%; transition: 0.3s; }
        .mp-fill { height: 100%; background: var(--mp-color); width: 0%; transition: 0.3s; }

        /* é…ç½® */
        #e0 { top: 80px; right: 120px; scale: 1.8; }
        #p0 { bottom: 130px; left: 80px; }
        #p1 { bottom: 100px; left: 200px; }
        #p2 { bottom: 70px; left: 320px; }

        /* ã‚³ãƒãƒ³ãƒ‰ãƒ‘ãƒãƒ« */
        #ui-panel { 
            width: 800px; background: var(--panel-bg); display: flex; 
            padding: 15px; border-top: 2px solid #444; box-sizing: border-box; gap: 10px;
        }
        .unit-command { flex: 1; background: #151520; padding: 10px; border-radius: 8px; border: 1px solid #333; }
        .unit-name { font-size: 12px; color: #888; margin-bottom: 5px; }
        
        select { 
            width: 100%; background: #222; color: #fff; border: 1px solid #444; 
            padding: 5px; border-radius: 4px; font-size: 13px; outline: none;
        }

        #action-btn { 
            width: 120px; background: #e74c3c; color: #fff; border: none; 
            border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 18px;
            transition: 0.2s; box-shadow: 0 4px 0 #c0392b;
        }
        #action-btn:active { transform: translateY(4px); box-shadow: none; }
        #action-btn:disabled { background: #555; box-shadow: none; cursor: not-allowed; }

        /* ãƒ­ã‚° */
        #log { position: absolute; top: 15px; left: 15px; background: rgba(0,0,0,0.6); padding: 8px 15px; border-radius: 20px; font-size: 14px; color: #00d4ff; border: 1px solid #00d4ff; }
    </style>
</head>
<body>

<div id="game-container">
    <div id="log">ä½œæˆ¦ã‚’æ±ºå®šã›ã‚ˆ</div>
    <div id="e0" class="char">
        <div class="bars"><div class="bar-bg"><div id="hp-e0" class="hp-fill"></div></div></div>
        <div class="icon">ğŸŒ‹</div>
    </div>
    <div id="p0" class="char">
        <div class="bars">
            <div class="bar-bg"><div id="hp-p0" class="hp-fill"></div></div>
            <div class="bar-bg"><div id="mp-p0" class="mp-inner" style="height:100%; width:0%; background:var(--mp-color); transition:0.3s;"></div></div>
        </div>
        <div class="icon">ğŸ¤œ</div>
    </div>
    <div id="p1" class="char">
        <div class="bars">
            <div class="bar-bg"><div id="hp-p1" class="hp-fill"></div></div>
            <div class="bar-bg"><div id="mp-p1" class="mp-inner" style="height:100%; width:0%; background:var(--mp-color); transition:0.3s;"></div></div>
        </div>
        <div class="icon">ğŸ‘“</div>
    </div>
    <div id="p2" class="char">
        <div class="bars">
            <div class="bar-bg"><div id="hp-p2" class="hp-fill"></div></div>
            <div class="bar-bg"><div id="mp-p2" class="mp-inner" style="height:100%; width:0%; background:var(--mp-color); transition:0.3s;"></div></div>
        </div>
        <div class="icon">ğŸ¥</div>
    </div>
</div>

<div id="ui-panel">
    <div class="unit-command">
        <div class="unit-name">ã‚¢ã‚¿ãƒƒã‚«ãƒ¼</div>
        <select id="sel0">
            <option value="atk">é€šå¸¸ï¼šå‘ªæ’ƒ (+20MP)</option>
            <option value="skill">ã‚¹ã‚­ãƒ«ï¼šé»’é–ƒ (30MP)</option>
            <option value="ult">å¥¥ç¾©ï¼šå¾„åº­æ‹³ (100MP)</option>
        </select>
    </div>
    <div class="unit-command">
        <div class="unit-name">ãƒãƒƒãƒ•ã‚¡ãƒ¼</div>
        <select id="sel1">
            <option value="atk">é€šå¸¸ï¼šå‘ªæ’ƒ (+20MP)</option>
            <option value="buff">ã‚¹ã‚­ãƒ«ï¼šæˆ¦æ„ (40MP)</option>
        </select>
    </div>
    <div class="unit-command">
        <div class="unit-name">ãƒ’ãƒ¼ãƒ©ãƒ¼</div>
        <select id="sel2">
            <option value="atk">é€šå¸¸ï¼šå‘ªæ’ƒ (+20MP)</option>
            <option value="heal">ã‚¹ã‚­ãƒ«ï¼šåè»¢ (50MP)</option>
        </select>
    </div>
    <button id="action-btn" onclick="startTurn()">ç¥“ æ‰•</button>
</div>

<script>
    class Unit {
        constructor(id, name, hp, mp) {
            this.id = id; this.name = name;
            this.hp = hp; this.maxHp = hp;
            this.mp = mp; this.buff = 1;
        }
        update() {
            document.getElementById(`hp-${this.id}`).style.width = (this.hp/this.maxHp*100) + "%";
            const m = document.getElementById(`mp-${this.id}`);
            if(m) m.style.width = this.mp + "%";
        }
    }

    const ps = [new Unit("p0", "è™æ–", 150, 0), new Unit("p1", "ä¸ƒæµ·", 120, 0), new Unit("p2", "å®¶å…¥", 100, 0)];
    const boss = new Unit("e0", "ç‰¹ç´š", 1500, 0);

    const log = (m) => document.getElementById('log').innerText = m;

    async function startTurn() {
        document.getElementById('action-btn').disabled = true;

        for(let i=0; i<3; i++) {
            const move = document.getElementById(`sel${i}`).value;
            const cost = {atk:0, skill:30, ult:100, buff:40, heal:50}[move];
            
            if(ps[i].mp < cost) {
                log(`${ps[i].name}ã®å‘ªåŠ›ãŒè¶³ã‚Šãªã„ï¼`);
                continue;
            }
            ps[i].mp -= cost;
            await execute(ps[i], move);
        }

        if(boss.hp > 0) await enemyTurn();
        document.getElementById('action-btn').disabled = false;
        log("ä½œæˆ¦ã‚’æ±ºå®šã›ã‚ˆ");
    }

    async function execute(p, move) {
        log(`${p.name}ã®è¡Œå‹•ï¼`);
        const el = document.getElementById(p.id);
        
        if(move === 'atk' || move === 'skill' || move === 'ult') {
            el.style.transform = "translateX(60px)";
            let d = {atk:40, skill:100, ult:400}[move];
            d *= p.buff; p.buff = 1;
            boss.hp = Math.max(0, boss.hp - d);
            if(move === 'atk') p.mp = Math.min(100, p.mp + 25);
            boss.update();
        } else if(move === 'buff') {
            el.style.transform = "translateY(-20px)";
            ps[0].buff = 2.0;
        } else if(move === 'heal') {
            el.style.transform = "translateY(-20px)";
            ps.forEach(u => { u.hp = Math.min(u.maxHp, u.hp + 50); u.update(); });
        }
        
        p.update();
        await new Promise(r => setTimeout(r, 600));
        el.style.transform = "";
    }

    async function enemyTurn() {
        log("æ•µã®æ”»æ’ƒï¼");
        const target = ps[Math.floor(Math.random()*3)];
        document.getElementById('e0').style.transform = "translateX(-80px)";
        target.hp = Math.max(0, target.hp - 35);
        target.update();
        await new Promise(r => setTimeout(r, 600));
        document.getElementById('e0').style.transform = "";
    }
</script>
</body>
</html>