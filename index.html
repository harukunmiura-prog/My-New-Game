<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ãƒ•ã‚¡ãƒ³ãƒ‘ãƒ¬é¢¨ï¼šå…±é—˜ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—</title>
    <style>
        body { background: #05050a; color: white; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; margin: 0; overflow: hidden; }
        #game-screen { width: 800px; height: 500px; border: 2px solid #333; position: relative; background: radial-gradient(circle, #1a1a2e, #05050a); }
        
        /* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å‘¨ã‚Š */
        .status-box { background: rgba(0,0,0,0.8); border-left: 4px solid #3498db; padding: 8px; margin-bottom: 5px; width: 180px; font-size: 13px; }
        .hp-bar-bg { width: 100%; height: 8px; background: #222; margin-top: 4px; border-radius: 4px; }
        .hp-bar-fill { height: 100%; background: #2ecc71; width: 100%; transition: 0.3s; }
        .buff-badge { display: inline-block; font-size: 10px; background: #f1c40f; color: black; padding: 1px 4px; border-radius: 3px; margin-top: 5px; display: none; }

        /* ã‚­ãƒ£ãƒ©é…ç½® */
        .unit { position: absolute; font-size: 70px; transition: 0.3s; text-align: center; }
        .unit-name { font-size: 14px; display: block; margin-top: -10px; }
        #p1 { bottom: 150px; left: 100px; } /* ã‚¢ã‚¿ãƒƒã‚«ãƒ¼ */
        #p2 { bottom: 120px; left: 240px; } /* ã‚µãƒãƒ¼ã‚¿ãƒ¼ */
        #enemy { top: 120px; right: 120px; font-size: 100px; }

        /* UI */
        #ui-panel { position: absolute; bottom: 0; width: 100%; height: 130px; background: #111; border-top: 2px solid #444; display: flex; }
        #log-area { flex: 1; padding: 15px; font-size: 14px; border-right: 1px solid #333; overflow-y: auto; color: #ccc; }
        #cmd-area { width: 350px; padding: 10px; display: flex; flex-direction: column; gap: 10px; justify-content: center; }
        .btn-row { display: flex; gap: 5px; justify-content: center; }
        button { flex: 1; padding: 8px; cursor: pointer; font-weight: bold; border: none; border-radius: 4px; }
        .p1-btn { background: #e74c3c; color: white; }
        .p2-btn { background: #3498db; color: white; }
        button:disabled { opacity: 0.3; cursor: not-allowed; }
    </style>
</head>
<body>

<div id="game-screen">
    <div style="position:absolute; top:20px; right:20px;">
        <div class="status-box" style="border-color: #e74c3c;">
            <span>ç‰¹ç´šå‘ªéœŠ</span>
            <div class="hp-bar-bg"><div id="e-hp" class="hp-bar-fill"></div></div>
        </div>
    </div>

    <div style="position:absolute; top:20px; left:20px;">
        <div class="status-box">
            <span>ã‚¢ã‚¿ãƒƒã‚«ãƒ¼</span>
            <div class="hp-bar-bg"><div id="p1-hp" class="hp-bar-fill"></div></div>
            <div id="p1-buff" class="buff-badge">æ”»æ’ƒUPä¸­</div>
        </div>
        <div class="status-box" style="border-color: #9b59b6;">
            <span>ã‚µãƒãƒ¼ã‚¿ãƒ¼</span>
            <div class="hp-bar-bg"><div id="p2-hp" class="hp-bar-fill"></div></div>
        </div>
    </div>

    <div id="enemy" class="unit">ğŸ‘¿</div>
    <div id="p1" class="unit">âš”ï¸<span class="unit-name">ã‚¢ã‚¿ãƒƒã‚«ãƒ¼</span></div>
    <div id="p2" class="unit">ğŸª„<span class="unit-name">ã‚µãƒãƒ¼ã‚¿ãƒ¼</span></div>

    <div id="ui-panel">
        <div id="log-area">ãƒãƒˆãƒ«ã®æº–å‚™ãŒæ•´ã£ãŸï¼</div>
        <div id="cmd-area">
            <div class="btn-row">
                <button class="p1-btn" onclick="p1Action()">ã‚¢ã‚¿ãƒƒã‚«ãƒ¼ï¼šå‘ªæ’ƒ</button>
            </div>
            <div class="btn-row">
                <button class="p2-btn" onclick="p2Buff()">ã‚µãƒãƒ¼ã‚¿ãƒ¼ï¼šé¼“èˆ (ãƒãƒ•)</button>
                <button class="p2-btn" onclick="p2Heal()">ã‚µãƒãƒ¼ã‚¿ãƒ¼ï¼šåè»¢è¡“å¼ (å›å¾©)</button>
            </div>
        </div>
    </div>
</div>

<script>
    let p1HP = 100, p2HP = 100, eHP = 200;
    let isBuffed = false;
    let turnCount = 0;

    function log(msg) {
        const l = document.getElementById('log-area');
        l.innerHTML = `<div>${msg}</div>` + l.innerHTML;
    }

    function updateUI() {
        document.getElementById('p1-hp').style.width = p1HP + "%";
        document.getElementById('p2-hp').style.width = p2HP + "%";
        document.getElementById('e-hp').style.width = (eHP / 2) + "%";
        document.getElementById('p1-buff').style.display = isBuffed ? "inline-block" : "none";
        
        if (eHP <= 0) {
            log("<strong>å‹åˆ©ï¼å‘ªéœŠã‚’é€€ã‘ãŸï¼</strong>");
            document.getElementById('enemy').style.display = 'none';
            disableButtons(true);
        }
    }

    function disableButtons(bool) {
        const btns = document.querySelectorAll('button');
        btns.forEach(b => b.disabled = bool);
    }

    // ã‚¢ã‚¿ãƒƒã‚«ãƒ¼ã®è¡Œå‹•
    async function p1Action() {
        disableButtons(true);
        let dmg = isBuffed ? 50 : 25;
        eHP = Math.max(0, eHP - dmg);
        log(`ã‚¢ã‚¿ãƒƒã‚«ãƒ¼ã®æ”»æ’ƒï¼æ•µã« ${dmg} ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼`);
        animate('p1', 50);
        isBuffed = false; // ãƒãƒ•ã¯1å›ã§æ¶ˆè²»
        updateUI();
        if (eHP > 0) setTimeout(enemyTurn, 1000);
    }

    // ã‚µãƒãƒ¼ã‚¿ãƒ¼ã®è¡Œå‹•ï¼ˆãƒãƒ•ï¼‰
    async function p2Buff() {
        disableButtons(true);
        isBuffed = true;
        log("ã‚µãƒãƒ¼ã‚¿ãƒ¼ã®é¼“èˆï¼ã‚¢ã‚¿ãƒƒã‚«ãƒ¼ã®æ¬¡ã®ä¸€æ’ƒãŒå¼·åŒ–ã•ã‚ŒãŸï¼");
        animate('p2', 0, -20);
        updateUI();
        setTimeout(enemyTurn, 1000);
    }

    // ã‚µãƒãƒ¼ã‚¿ãƒ¼ã®è¡Œå‹•ï¼ˆå›å¾©ï¼‰
    async function p2Heal() {
        disableButtons(true);
        p1HP = Math.min(100, p1HP + 30);
        p2HP = Math.min(100, p2HP + 30);
        log("åè»¢è¡“å¼ï¼å‘³æ–¹å…¨å“¡ã®HPãŒå›å¾©ï¼");
        animate('p2', 0, -20);
        updateUI();
        setTimeout(enemyTurn, 1000);
    }

    function enemyTurn() {
        const target = Math.random() > 0.5 ? "p1" : "p2";
        log(`æ•µã®æ”»æ’ƒï¼${target === "p1" ? "ã‚¢ã‚¿ãƒƒã‚«ãƒ¼" : "ã‚µãƒãƒ¼ã‚¿ãƒ¼"}ãŒç‹™ã‚ã‚ŒãŸï¼`);
        animate('enemy', -50);
        
        if (target === "p1") p1HP = Math.max(0, p1HP - 20);
        else p2HP = Math.max(0, p2HP - 20);
        
        updateUI();
        setTimeout(() => {
            if (p1HP > 0 || p2HP > 0) {
                disableButtons(false);
                log("å‘³æ–¹ã®ã‚¿ãƒ¼ãƒ³ï¼");
            } else {
                log("å…¨æ»…ã—ã¾ã—ãŸ...");
            }
        }, 800);
    }

    function animate(id, x = 0, y = 0) {
        const el = document.getElementById(id);
        el.style.transform = `translate(${x}px, ${y}px)`;
        setTimeout(() => el.style.transform = 'translate(0, 0)', 150);
    }
</script>
</body>
</html>